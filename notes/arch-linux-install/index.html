<!doctype html><html class=no-js>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=HandheldFriendly content="True">
<meta name=MobileOptimized content="320">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.87.0">
<title>Arch Linux Installation &#183; Jon Cain üë®‚Äçüíª (jonifen.co.uk)</title>
<link rel=preload href=/css/jonifen.min.css as=style>
<link rel=preload href=/css/jonifen-fonts.min.css as=style>
<link rel=preload href=/fonts/AleoNormal400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/fonts/OswaldLight300.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/fonts/OswaldNormal400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/fonts/OxygenMonoNormal400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/fonts/SourceSansProRegular400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/fonts/icomoon.woff as=font type=font/woff crossorigin=anonymous>
<meta property="og:site_name" content="Jon Cain üë®‚Äçüíª (jonifen.co.uk)">
<meta property="og:title" content="Arch Linux Installation">
<meta name=description content="The sequence I typically follow to install Arch Linux onto a machine as of 25th April 2020)">
<meta property="og:description" content="The sequence I typically follow to install Arch Linux onto a machine as of 25th April 2020)">
<meta property="og:image:secure_url" imageprop=image content="https://jonifen.co.uk/images/og-avatar.png">
<meta property="og:type" content="website">
<link rel=stylesheet href=/css/jonifen.min.css>
<link rel=stylesheet href=/css/jonifen-fonts.min.css>
</head>
<body>
<a name=top></a>
<a href=#top class=back-to-top style=display:none><div></div></a>
<header id=header>
<div class=container>
<div class=heading>
<a href=/>jonifen</a>
</div>
<ul class=nav>
<li class=nav-item><a href=/blog/ alt=Blog title=Blog><span>Blog</span></a></li><li class=nav-item><a href=/notes/ alt=Notes title=Notes><span>Notes</span></a></li><li class=nav-item><a href=/projects/ alt=Projects title=Projects><span>Projects</span></a></li><li class=nav-item><a href=/about/ alt=About title=About><span>About</span></a></li>
</ul>
</div>
</header>
<div class=page-content>
<div class=post-header>
<div class=container>
<div class=content>
<p><a href=/notes/>&lt; Back to Notes</a></p>
<h2>Arch Linux Installation</h2>
<nav id=TableOfContents>
<ul>
<li><a href=#initial-steps>Initial steps</a>
<ul>
<li><a href=#set-keyboard-layout-to-uk>Set keyboard layout to UK</a></li>
<li><a href=#set-timezone-and-enable-ntp>Set timezone and enable NTP</a></li>
</ul>
</li>
<li><a href=#disk-setup>Disk setup</a>
<ul>
<li><a href=#formatting-a-partition-assuming-ext4-which-is-most-common>Formatting a partition (assuming <code>ext4</code> which is most common)</a></li>
<li><a href=#formatting-the-swap-partition>Formatting the swap partition</a></li>
</ul>
</li>
<li><a href=#get-ready-to-install-mount-drives>Get ready to install (mount drives)</a></li>
<li><a href=#install-the-basics>Install the basics</a></li>
<li><a href=#create-the-fstab-file>Create the fstab file</a></li>
<li><a href=#chroot-into-the-installed-os>Chroot into the installed OS</a></li>
<li><a href=#next-steps>Next steps&mldr;</a>
<ul>
<li><a href=#set-the-locale>Set the locale</a></li>
<li><a href=#set-the-hardware-clock>Set the hardware clock</a></li>
<li><a href=#name-the-computer-set-up-hostname>Name the computer (set up hostname)</a></li>
<li><a href=#install-zsh-if-you-prefer-it-to-bash>Install zsh (if you prefer it to bash)</a></li>
<li><a href=#add-your-everyday-user-account-and-set-the-password>Add your everyday user account and set the password</a></li>
<li><a href=#add-user-to-sudoers-optional>Add user to sudoers (optional)</a></li>
<li><a href=#create-a-new-initramfs-file>Create a new initramfs file</a></li>
<li><a href=#set-up-grub-bootloader>Set up grub (bootloader)</a></li>
<li><a href=#install-any-additional-utilities-window-managers-etc>Install any additional utilities, window managers etc.</a></li>
</ul>
</li>
<li><a href=#network-connectivity>Network connectivity</a>
<ul>
<li><a href=#networkmanager>NetworkManager</a></li>
<li><a href=#wpa-supplicant-wifi-only>WPA Supplicant (wifi only)</a></li>
<li><a href=#iwd>iwd</a></li>
</ul>
</li>
<li><a href=#final-steps-and-reboot>Final steps (and reboot)</a></li>
<li><a href=#additional-packages>Additional packages</a>
<ul>
<li><a href=#fonts>Fonts</a></li>
</ul>
</li>
<li><a href=#gotchas>Gotchas</a>
<ul>
<li><a href=#signature-is-unknown-trust>Signature is unknown trust</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class=container>
<div class=main-content>
<p>This is a list of the commands I&rsquo;d run to set up a machine with Arch Linux as of today (25th April 2020).</p>
<p>First of all, create a bootable USB (or CD) based on the ISO downloaded from the main Arch Linux website and boot it up.</p>
<h2 id=initial-steps>Initial steps</h2>
<h3 id=set-keyboard-layout-to-uk>Set keyboard layout to UK</h3>
<pre><code>loadkeys uk
</code></pre><p>Connect to the Internet (Ethernet is easier, but Wireless is just as easy) before continuing&mldr;</p>
<h3 id=set-timezone-and-enable-ntp>Set timezone and enable NTP</h3>
<p>Set the time zone to London and enable NTP for keeping the time/date synchronised.</p>
<pre><code>timedatectl set-timezone Europe/London
timedatectl set-ntp true
</code></pre><h2 id=disk-setup>Disk setup</h2>
<p>Create your disk partition layouts at this point using the preferred disk partition tool (fdisk, cfdisk, parted etc.) but remember that if you&rsquo;re enabling encryption, create the partitions accordingly.</p>
<p>Remember that I always recommend <code>/home</code> being on a separate partition!</p>
<h3 id=formatting-a-partition-assuming-ext4-which-is-most-common>Formatting a partition (assuming <code>ext4</code> which is most common)</h3>
<pre><code>mkfs.ext4 /dev/sda1
</code></pre><p>or without journaling enabled</p>
<pre><code>mkfs.ext4 -O &quot;^has_journal&quot; /dev/sda1
</code></pre><p>or with BTRFS instead</p>
<pre><code>mkfs.btrfs /dev/sda1
</code></pre><h3 id=formatting-the-swap-partition>Formatting the swap partition</h3>
<pre><code>mkswap /dev/sda2
</code></pre><h2 id=get-ready-to-install-mount-drives>Get ready to install (mount drives)</h2>
<pre><code>mount /dev/sda3 /mnt
mkdir /mnt/home
mount /dev/sda4 /home
</code></pre><p>and if you created a separate <code>/boot</code> partition</p>
<pre><code>mkdir /mnt/boot
mount /dev/sda1 /boot
</code></pre><p>and finally enable the <code>swap</code> partition</p>
<pre><code>swapon /dev/sda2
</code></pre><h2 id=install-the-basics>Install the basics</h2>
<pre><code>pacstrap /mnt base base-devel linux linux-firmware
</code></pre><h2 id=create-the-fstab-file>Create the fstab file</h2>
<pre><code>genfstab -U /mnt &gt;&gt; /mnt/etc/fstab
</code></pre><h2 id=chroot-into-the-installed-os>Chroot into the installed OS</h2>
<pre><code>arch-chroot /mnt
</code></pre><h2 id=next-steps>Next steps&mldr;</h2>
<p>Set the root password - <strong>make it secure!</strong></p>
<pre><code>passwd
</code></pre><h3 id=set-the-locale>Set the locale</h3>
<p>Edit <code>/etc/locale.gen</code> to uncomment any <code>en_GB</code> entries before generating the locale file</p>
<pre><code>locale-gen
echo LANG=en_GB.UTF-8 &gt; /etc/locale.conf
echo KEYMAP=uk &gt; /etc/vconsole.conf
</code></pre><h3 id=set-the-hardware-clock>Set the hardware clock</h3>
<pre><code>ln -sf /usr/share/zoneinfo/Europe/London /etc/localtime
hwclock --systohc
</code></pre><h3 id=name-the-computer-set-up-hostname>Name the computer (set up hostname)</h3>
<pre><code>echo {name} &gt; /etc/hostname
echo 127.0.1.1 {name}.localdomain {name} &gt;&gt; /etc/hosts
</code></pre><h3 id=install-zsh-if-you-prefer-it-to-bash>Install zsh (if you prefer it to bash)</h3>
<pre><code>pacman -S zsh
</code></pre><h3 id=add-your-everyday-user-account-and-set-the-password>Add your everyday user account and set the password</h3>
<p>(replace <code>zsh</code> with <code>bash</code> if you skipped the last step)</p>
<pre><code>useradd -m -g users -G wheel -s /bin/zsh {username}
passwd {username}
</code></pre><h3 id=add-user-to-sudoers-optional>Add user to sudoers (optional)</h3>
<p>Replace {editor} with the editor of choice - <code>nano</code> should already be installed.</p>
<pre><code>EDITOR={editor} visudo
</code></pre><p>Uncomment the line below to allow all users in <code>wheel</code> group to run root commands</p>
<pre><code>%wheel ALL=(ALL) ALL
</code></pre><h3 id=create-a-new-initramfs-file>Create a new initramfs file</h3>
<p>Remember to update <code>/etc/mkinitcpio.conf</code> if you&rsquo;re using an encrypted disk to make sure the correct things are loaded before running the following:</p>
<pre><code>mkinitcpio -P
</code></pre><h3 id=set-up-grub-bootloader>Set up grub (bootloader)</h3>
<pre><code>pacman -S grub
grub-install /dev/sda
</code></pre><p>If you have any customisations to make to the boot command line, make them in <code>/etc/default/grub</code> now!</p>
<pre><code>grub-mkconfig -o /boot/grub/grub.cfg
</code></pre><h3 id=install-any-additional-utilities-window-managers-etc>Install any additional utilities, window managers etc.</h3>
<h4 id=kdeplasma--sddm>KDE/Plasma & SDDM</h4>
<pre><code>pacman -S plasma sddm
</code></pre><p>Enable the SDDM service so it&rsquo;s launched on boot:</p>
<pre><code>systemctl enable sddm
</code></pre><h4 id=openbox>Openbox</h4>
<p>This is my choice on low powered machines, and I don&rsquo;t include a display manager (but you can add one if you like though). Remember that you&rsquo;ll need to start X yourself with <code>startx</code>.</p>
<pre><code>pacman -S xorg-server xorg-xinit xorg-apps openbox obconf lxappearance
</code></pre><p>Use the example xinitrc file as your base:</p>
<pre><code>cp /etc/X11/xinit/xinitrc ~/.xinitrc
</code></pre><p>edit the file to comment out the last block (starts with <code>twm</code> and includes references to <code>xterm</code> etc.) and then add the following at the bottom:</p>
<pre><code>exec openbox-session
</code></pre><h4 id=terminal>Terminal</h4>
<p>Take your pick from <code>konsole</code> (my preferred in KDE), <code>xterm</code> (very simple), <code>sakura</code> (basic with some features).</p>
<h2 id=network-connectivity>Network connectivity</h2>
<p>You&rsquo;ll probably need to install some packages to help you get a network connection post-reboot. Here are a few options:</p>
<h3 id=networkmanager>NetworkManager</h3>
<p>Should get installed with KDE, but if you&rsquo;ve opted for something else, needs installing manually:</p>
<pre><code>pacman -S network-manager network-manager-applet
</code></pre><p>and then the service needs enabling:</p>
<pre><code>sudo systemctl enable NetworkManager
sudo systemctl start NetworkManager
</code></pre><h3 id=wpa-supplicant-wifi-only>WPA Supplicant (wifi only)</h3>
<pre><code>pacman -S dialog wpa_supplicant
</code></pre><p>once installed:</p>
<pre><code>sudo wifi-menu
</code></pre><p>it will save your profile as a network service, view all options:</p>
<pre><code>sudo netctl list
</code></pre><p>and enable the one you want:</p>
<pre><code>sudo netctl enable {profile_name}
</code></pre><h3 id=iwd>iwd</h3>
<p>Install the <code>iwd</code> package from the registry and start it with:</p>
<pre><code>iwctl
</code></pre><p>At the interactive prompt:</p>
<pre><code># show the installed wifi adapters
devices list

# scan for networks
station {wlan} scan

# show the networks found in the scan
station {wlan} get-networks

# connect to a network (it will prompt for PSK)
station {wlan} connect {network_name}
</code></pre><p>I also had to install the <code>dhcp</code> package and then enable the daemon, along with the DNS resolver in systemd:</p>
<pre><code>systemctl enable dhcpd
systemctl enable systemd-resolved
</code></pre><h2 id=final-steps-and-reboot>Final steps (and reboot)</h2>
<p>Exit from the chroot shell, unmount all partitions and reboot:</p>
<pre><code>exit
umount -R /mnt
reboot
</code></pre><h2 id=additional-packages>Additional packages</h2>
<p>There are additional packages that I tend to install after a base install. Some of these are related to software development, some are not.</p>
<ul>
<li>Yay (AUR helper, saves a few keypresses for installing packages via AUR)</li>
<li>nvm (Node Version Manager - this is available on AUR and can be installed with Yay)</li>
<li>OpenSSH (ssh - because it&rsquo;s not installed by default)</li>
<li>Visual Studio Code - I install the MS one from AUR because some plugins that I&rsquo;ve become pretty used to aren&rsquo;t in the open repository: <code>visual-studio-code-bin</code></li>
<li>docker and docker-compose (both available from official Arch Linux repositories)</li>
<li>kamoso (camera utility for KDE)</li>
<li>pulseaudio-equalizer (audio equaliser for pulseaudio - it sets itself up as an additional audio controller, so it affects <em>all</em> audio output)</li>
</ul>
<h3 id=fonts>Fonts</h3>
<p>These can be installed from the standard Arch Linux package registry.</p>
<ul>
<li>Hack: ttf-hack</li>
<li>Noto Fonts: noto-fonts noto-fonts-emoji noto-fonts-extra</li>
</ul>
<h2 id=gotchas>Gotchas</h2>
<h3 id=signature-is-unknown-trust>Signature is unknown trust</h3>
<pre><code>signature from &quot;{name} &lt;{email}&gt;&quot; is unknown trust
</code></pre><p>As per the Arch docs <a href=https://wiki.archlinux.org/title/Pacman#Signature_from_%22User_%3Cemail@example.org%3E%22_is_unknown_trust,_installation_failed>here</a>, there are a few possible solutions but I&rsquo;ve had success with installing the <code>archlinux-keyring</code> package and then doing a pacman update:</p>
<pre><code>sudo pacman -Sy archlinux-keyring
sudo pacman -Su
</code></pre>
</div>
</div>
<footer>
<div class=container>
<div class=footer-icons>
<a href=https://github.com/jonifen/ target=_blank rel="noopener noreferrer"><span class=icon-github></span></a>
<a href=https://twitter.com/jonifen/ target=_blank rel="noopener noreferrer"><span class=icon-twitter></span></a>
<a href=https://linkedin.com/in/jonifen/ target=_blank rel="noopener noreferrer"><span class=icon-linkedin2></span></a>
<a href=https://www.reddit.com/user/jonifen target=_blank rel="noopener noreferrer"><span class=icon-reddit></span></a>
<a href=http://stackoverflow.com/users/3157725/jonifen target=_blank rel="noopener noreferrer"><span class=icon-stackoverflow></span></a>
<a href="mailto:hello@jonifen.co.uk?subject=Contact%20from%20your%20website" target=_blank><span class=icon-mail2></span></a>
</div>
<p>
<a href=https://jonifen.co.uk>jonifen.co.uk</a> - Created using <a href=https://gohugo.io>Hugo</a>
</p>
</div>
</footer>
</div>
</body>
</html>