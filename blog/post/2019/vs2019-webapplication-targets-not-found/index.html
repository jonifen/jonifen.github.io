<!DOCTYPE html>
<html class="no-js">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>The imported project &#34;.../Microsoft.WebApplication.targets&#34; was not found  &middot; Jon Cain</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
    <meta name="description" content="" />
  

  <link rel="stylesheet" href="/css/jonifen.css">
</head>
<body>
  <header>
    <div class="container">
      <div class="heading">
        <a href="/">Jon Cain</a>
      </div>
      <div class="nav">
	<a href="/" class="nav-item" alt="Home" title="Home">Home</a><a href="/blog/" class="nav-item" alt="Blog" title="Blog">Blog</a><a href="/projects/" class="nav-item" alt="Projects" title="Projects">Projects</a><a href="/contact/" class="nav-item" alt="Contact" title="Contact">Contact</a>
</div>
    </div>
  </header>
  <div class="page-content">
<div class="post-header">
  <div class="container">
    <div class="content">
      <h2>The imported project &#34;.../Microsoft.WebApplication.targets&#34; was not found</h2>
      <div class="post-details">
        
  <small>
    Reading time: ~2 minutes (253 words)
  </small>

      </div>
      <div class="post-meta-details">
        <div class="date">
          <small>
	<time datetime="2019-06-17">
		17 Jun, 2019
	</time>
</small>

        </div>
        <div class="tags">
          
	
		<a href="/tags/programming" class="tag">programming</a>
	
		<a href="/tags/visualstudio" class="tag">visualstudio</a>
	


        </div>
      </div>
    </div>
  </div>
</div>
<div class="container">
  <div class="content">
    <p>We have an existing web application project at work which was failing to open in Visual Studio 2019 with the following error:</p>

<pre><code>The imported project &quot;C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\MSBuild\Microsoft\VisualStudio\vCurrent\WebApplications\Microsoft.WebApplication.targets&quot; was not found.
</code></pre>

<p>After some research, I came across this a <a href="https://developercommunity.visualstudio.com/content/problem/414282/vs-2019-webapplication-projects-fail-to-load.html">VS Community post</a> where Microsoft have deemed it to be under consideration, but after a few months, it&rsquo;s still outstanding.</p>

<p>Figuring out that the issue could surround the <code>vCurrent</code> part of the path, I did a bit more research, coming across another <a href="https://developercommunity.visualstudio.com/content/problem/404485/vs2019-msbuildtoolsversion-is-not-a-version.html">VS Community post</a> which discusses this point, and it turns out that Microsoft have changed the <code>MSBuildToolsVersion</code> variable to output <code>Current</code> rather than the version (as it did previously). Luckily, Jim Waite has posted <a href="https://developercommunity.visualstudio.com/comments/477080/view.html">a useful workaround</a> which appears to have fixed the problem I was having (which I quote):</p>

<pre><code>The MSBuild folder has indeed been renamed to &quot;Current&quot;, however there are still sub-folders in there that are using the old numeric convention.

For example, this one:

C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\MSBuild\Microsoft\VisualStudio\v16.0

Any build scripts that refer to this folder using ...\VisualStudio\v$(MSBuildToolsVersion) will no longer work.

Shouldnt the sub-folders all follow the same &quot;Current&quot; convention?

So above folder would become:

C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\MSBuild\Microsoft\VisualStudio\vCurrent

In the meantime, it can be worked around (but this is not very nice) by replacing $(MSBuildToolsVersion) with $(MSBuildAssemblyVersion) in build scripts.
</code></pre>

<p>So looking in our *.csproj file, I found an import element as follows:</p>

<pre><code>&lt;Import Project=&quot;$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(MSBuildToolsVersion)\WebApplications\Microsoft.WebApplication.targets&quot; /&gt;
</code></pre>

<p>which just needed changing to:</p>

<pre><code>&lt;Import Project=&quot;$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(MSBuildAssemblyVersion)\WebApplications\Microsoft.WebApplication.targets&quot; /&gt;
</code></pre>

<p>and it looks like the problem has gone away.</p>

    
  </div>
</div>
      <footer>
        <div class="container">
          <small>
            
              <a href="https://jonifen.co.uk">jonifen.co.uk</a> - Created using <a href="https://gohugo.io">Hugo</a>
            
          </small>
        </div>
      </footer>
    </div>
  </body>
</html>

